<!DOCTYPE html>
<html lang="en"><head><title>CUDA</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="CUDA"/><meta property="og:description" content="docs.nvidia.com/cuda/cuda-c-programming-guide/ Definition host: the CPU device: the GPU host memory: the system main memory device memory: onboard memory on a GPU card kernels: ..."/><meta property="og:image" content="static/og-image.png"/> <meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="docs.nvidia.com/cuda/cuda-c-programming-guide/ Definition host: the CPU device: the GPU host memory: the system main memory device memory: onboard memory on a GPU card kernels: ..."/><meta name="generator" content="Quartz"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="CUDA/CUDA"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title"><a href="..">üìù Notes</a></h1><div class="spacer mobile-only"></div><div class="search"><div id="search-icon"><p>Search</p><div></div><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabindex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div><div class="explorer desktop-only"><button type="button" id="explorer" data-behavior="collapse" data-collapsed="collapsed" data-savestate="true" data-tree="[{&quot;path&quot;:&quot;Advance-Energy-Systems&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Biology&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Computer-Architecture&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Computer-Vision&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Cryptography&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;CUDA&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Data-Structures-and-Algos&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Economics&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Education&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Large-Model-Systems&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Linux-Kernel-Development&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Memory&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;MRI&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Political-Theory&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Psychology&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Religion&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Religion/Bible&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Religion/Bible/Genesis&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Screenplay-Writing&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Verilog&quot;,&quot;collapsed&quot;:true}]"><h1>Explorer</h1><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-content"><ul class="overflow" id="explorer-ul"><li><div class="folder-outer open"><ul style="padding-left:0;" class="content" data-folderul><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Advance-Energy-Systems"><button class="folder-button"><span class="folder-title">Advance Energy Systems</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Advance-Energy-Systems"><li><a href="../Advance-Energy-Systems/control-rods" data-for="Advance-Energy-Systems/control-rods">control rods</a></li><li><a href="../Advance-Energy-Systems/Dyson-Spheres" data-for="Advance-Energy-Systems/Dyson-Spheres">Dyson Spheres</a></li><li><a href="../Advance-Energy-Systems/Fission-Reaction" data-for="Advance-Energy-Systems/Fission-Reaction">Fission Reaction</a></li><li><a href="../Advance-Energy-Systems/gaseous-diffusion" data-for="Advance-Energy-Systems/gaseous-diffusion">gaseous diffusion</a></li><li><a href="../Advance-Energy-Systems/moderator" data-for="Advance-Energy-Systems/moderator">moderator</a></li><li><a href="../Advance-Energy-Systems/Neutron-Scattering" data-for="Advance-Energy-Systems/Neutron-Scattering">Neutron Scattering</a></li><li><a href="../Advance-Energy-Systems/Nuclear-Power-Plants" data-for="Advance-Energy-Systems/Nuclear-Power-Plants">Nuclear Power Plants</a></li><li><a href="../Advance-Energy-Systems/Nuclear-Reactor" data-for="Advance-Energy-Systems/Nuclear-Reactor">Nuclear Reactor</a></li><li><a href="../Advance-Energy-Systems/The-Grid" data-for="Advance-Energy-Systems/The-Grid">The Grid</a></li><li><a href="../Advance-Energy-Systems/uranium-enrichment" data-for="Advance-Energy-Systems/uranium-enrichment">uranium enrichment</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Biology"><button class="folder-button"><span class="folder-title">Biology</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Biology"><li><a href="../Biology/The-Genetic-Code" data-for="Biology/The-Genetic-Code">The Genetic Code</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Computer-Architecture"><button class="folder-button"><span class="folder-title">Computer Architecture</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Computer-Architecture"><li><a href="../Computer-Architecture/AC" data-for="Computer-Architecture/AC">AC</a></li><li><a href="../Computer-Architecture/ARM-architecture" data-for="Computer-Architecture/ARM-architecture">ARM architecture</a></li><li><a href="../Computer-Architecture/CMOS" data-for="Computer-Architecture/CMOS">CMOS</a></li><li><a href="../Computer-Architecture/Compute-in-Memory-(CIM)" data-for="Computer-Architecture/Compute-in-Memory-(CIM)">Compute-in-Memory (CIM)</a></li><li><a href="../Computer-Architecture/Computer-Architecture" data-for="Computer-Architecture/Computer-Architecture">Computer Architecture</a></li><li><a href="../Computer-Architecture/inverter" data-for="Computer-Architecture/inverter">inverter</a></li><li><a href="../Computer-Architecture/NMOS" data-for="Computer-Architecture/NMOS">NMOS</a></li><li><a href="../Computer-Architecture/Parallel-Processors" data-for="Computer-Architecture/Parallel-Processors">Parallel Processors</a></li><li><a href="../Computer-Architecture/PMOS" data-for="Computer-Architecture/PMOS">PMOS</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Computer-Vision"><button class="folder-button"><span class="folder-title">Computer Vision</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Computer-Vision"><li><a href="../Computer-Vision/Slam" data-for="Computer-Vision/Slam">Slam</a></li></ul></div></li><li><div class="folder-outer "><ul style="padding-left:0;" class="content" data-folderul></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Cryptography"><button class="folder-button"><span class="folder-title">Cryptography</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Cryptography"><li><a href="../Cryptography/Cryptography" data-for="Cryptography/Cryptography">Cryptography</a></li><li><a href="../Cryptography/Mono-alphabetic-substition" data-for="Cryptography/Mono-alphabetic-substition">Mono-alphabetic substition</a></li><li><a href="../Cryptography/STARKs" data-for="Cryptography/STARKs">STARKs</a></li><li><a href="../Cryptography/The-Vigen√®re-(poly-alphabetic-shift)-cipher" data-for="Cryptography/The-Vigen√®re-(poly-alphabetic-shift)-cipher">The Vigen√®re (poly-alphabetic shift) cipher</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="CUDA"><button class="folder-button"><span class="folder-title">CUDA</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="CUDA"><li><a href="../CUDA/3-component-vector-that-represent-the-thread-index-within-a-block-1" data-for="CUDA/3-component-vector-that-represent-the-thread-index-within-a-block-1">3-component vector that represent the thread index within a block 1</a></li><li><a href="../CUDA/CUDA" data-for="CUDA/CUDA">CUDA</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Data-Structures-and-Algos"><button class="folder-button"><span class="folder-title">Data Structures and Algos</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Data-Structures-and-Algos"><li><a href="../Data-Structures-and-Algos/KD-Tree" data-for="Data-Structures-and-Algos/KD-Tree">KD Tree</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Economics"><button class="folder-button"><span class="folder-title">Economics</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Economics"><li><a href="../Economics/Wealth-of-Nations" data-for="Economics/Wealth-of-Nations">Wealth of Nations</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Education"><button class="folder-button"><span class="folder-title">Education</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Education"></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Large-Model-Systems"><button class="folder-button"><span class="folder-title">Large Model Systems</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Large-Model-Systems"><li><a href="../Large-Model-Systems/1-bit-LLMs" data-for="Large-Model-Systems/1-bit-LLMs">1 bit LLMs</a></li><li><a href="../Large-Model-Systems/Allreduce" data-for="Large-Model-Systems/Allreduce">Allreduce</a></li><li><a href="../Large-Model-Systems/CLIP" data-for="Large-Model-Systems/CLIP">CLIP</a></li><li><a href="../Large-Model-Systems/CUDA-API-of-GPT-2" data-for="Large-Model-Systems/CUDA-API-of-GPT-2">CUDA API of GPT 2</a></li><li><a href="../Large-Model-Systems/Deep-Dive-of-GPT-architecture" data-for="Large-Model-Systems/Deep-Dive-of-GPT-architecture">Deep Dive of GPT architecture</a></li><li><a href="../Large-Model-Systems/Gemini" data-for="Large-Model-Systems/Gemini">Gemini</a></li><li><a href="../Large-Model-Systems/How-a-Transformer-works-at-inference-vs-training-time" data-for="Large-Model-Systems/How-a-Transformer-works-at-inference-vs-training-time">How a Transformer works at inference vs training time</a></li><li><a href="../Large-Model-Systems/IEEE-754" data-for="Large-Model-Systems/IEEE-754">IEEE-754</a></li><li><a href="../Large-Model-Systems/Liger-Kernels" data-for="Large-Model-Systems/Liger-Kernels">Liger Kernels</a></li><li><a href="../Large-Model-Systems/LlaMa-from-scratch" data-for="Large-Model-Systems/LlaMa-from-scratch">LlaMa from scratch</a></li><li><a href="../Large-Model-Systems/LLaVA" data-for="Large-Model-Systems/LLaVA">LLaVA</a></li><li><a href="../Large-Model-Systems/MatMul-Free-Language-Modeling" data-for="Large-Model-Systems/MatMul-Free-Language-Modeling">MatMul-Free Language Modeling</a></li><li><a href="../Large-Model-Systems/ML-Interpretability" data-for="Large-Model-Systems/ML-Interpretability">ML Interpretability</a></li><li><a href="../Large-Model-Systems/Optical-Circuit-Switches" data-for="Large-Model-Systems/Optical-Circuit-Switches">Optical Circuit Switches</a></li><li><a href="../Large-Model-Systems/Positional-embeddings-matrix" data-for="Large-Model-Systems/Positional-embeddings-matrix">Positional embeddings matrix</a></li><li><a href="../Large-Model-Systems/Post-Training-Static-quantization" data-for="Large-Model-Systems/Post-Training-Static-quantization">Post-Training Static quantization</a></li><li><a href="../Large-Model-Systems/Quantization" data-for="Large-Model-Systems/Quantization">Quantization</a></li><li><a href="../Large-Model-Systems/queries-(Q),-keys-(K),-and-values-(V)" data-for="Large-Model-Systems/queries-(Q),-keys-(K),-and-values-(V)">queries (Q), keys (K), and values (V)</a></li><li><a href="../Large-Model-Systems/Silent-Data-Corruption-(SDC)" data-for="Large-Model-Systems/Silent-Data-Corruption-(SDC)">Silent Data Corruption (SDC)</a></li><li><a href="../Large-Model-Systems/Softmax" data-for="Large-Model-Systems/Softmax">Softmax</a></li><li><a href="../Large-Model-Systems/SparseCore" data-for="Large-Model-Systems/SparseCore">SparseCore</a></li><li><a href="../Large-Model-Systems/SSM-vs-Transformer" data-for="Large-Model-Systems/SSM-vs-Transformer">SSM vs Transformer</a></li><li><a href="../Large-Model-Systems/Token-embeddings-matrix" data-for="Large-Model-Systems/Token-embeddings-matrix">Token embeddings matrix</a></li><li><a href="../Large-Model-Systems/Tokenization" data-for="Large-Model-Systems/Tokenization">Tokenization</a></li><li><a href="../Large-Model-Systems/Torchserve" data-for="Large-Model-Systems/Torchserve">Torchserve</a></li><li><a href="../Large-Model-Systems/TPUv4" data-for="Large-Model-Systems/TPUv4">TPUv4</a></li><li><a href="../Large-Model-Systems/Training-GPT-from-Scratch" data-for="Large-Model-Systems/Training-GPT-from-Scratch">Training GPT from Scratch</a></li><li><a href="../Large-Model-Systems/Transformers" data-for="Large-Model-Systems/Transformers">Transformers</a></li><li><a href="../Large-Model-Systems/Vector-matrix-multiplication-(VMM)" data-for="Large-Model-Systems/Vector-matrix-multiplication-(VMM)">Vector-matrix multiplication (VMM)</a></li><li><a href="../Large-Model-Systems/VIdeo-understanding" data-for="Large-Model-Systems/VIdeo-understanding">VIdeo understanding</a></li><li><a href="../Large-Model-Systems/Vision-Transformer" data-for="Large-Model-Systems/Vision-Transformer">Vision Transformer</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Linux-Kernel-Development"><button class="folder-button"><span class="folder-title">Linux Kernel Development</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Linux-Kernel-Development"><li><a href="../Linux-Kernel-Development/linux_kernel_development" data-for="Linux-Kernel-Development/linux_kernel_development">linux_kernel_development</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Memory"><button class="folder-button"><span class="folder-title">Memory</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Memory"><li><a href="../Memory/Memory" data-for="Memory/Memory">Memory</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="MRI"><button class="folder-button"><span class="folder-title">MRI</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="MRI"></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Political-Theory"><button class="folder-button"><span class="folder-title">Political Theory</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Political-Theory"><li><a href="../Political-Theory/Political-Theory" data-for="Political-Theory/Political-Theory">Political Theory</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Psychology"><button class="folder-button"><span class="folder-title">Psychology</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Psychology"><li><a href="../Psychology/Developmental-Psychology" data-for="Psychology/Developmental-Psychology">Developmental Psychology</a></li><li><a href="../Psychology/Erickson" data-for="Psychology/Erickson">Erickson</a></li><li><a href="../Psychology/Piaget" data-for="Psychology/Piaget">Piaget</a></li><li><a href="../Psychology/Vygotsky" data-for="Psychology/Vygotsky">Vygotsky</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Religion"><button class="folder-button"><span class="folder-title">Religion</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Religion"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Religion/Bible"><button class="folder-button"><span class="folder-title">Bible</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Religion/Bible"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Religion/Bible/Genesis"><button class="folder-button"><span class="folder-title">Genesis</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Religion/Bible/Genesis"><li><a href="../Religion/Bible/Genesis/Genesis" data-for="Religion/Bible/Genesis/Genesis">Genesis</a></li><li><a href="../Religion/Bible/Genesis/Genesis-1-2" data-for="Religion/Bible/Genesis/Genesis-1-2">Genesis 1-2</a></li><li><a href="../Religion/Bible/Genesis/Genesis-3" data-for="Religion/Bible/Genesis/Genesis-3">Genesis 3</a></li><li><a href="../Religion/Bible/Genesis/Genesis-4-5" data-for="Religion/Bible/Genesis/Genesis-4-5">Genesis 4-5</a></li><li><a href="../Religion/Bible/Genesis/Genesis-6-9" data-for="Religion/Bible/Genesis/Genesis-6-9">Genesis 6-9</a></li><li><a href="../Religion/Bible/Genesis/Genesis-10-11" data-for="Religion/Bible/Genesis/Genesis-10-11">Genesis 10-11</a></li><li><a href="../Religion/Bible/Genesis/Genesis-12-25" data-for="Religion/Bible/Genesis/Genesis-12-25">Genesis 12-25</a></li><li><a href="../Religion/Bible/Genesis/Genesis-26-27" data-for="Religion/Bible/Genesis/Genesis-26-27">Genesis 26-27</a></li><li><a href="../Religion/Bible/Genesis/Genesis-28-36" data-for="Religion/Bible/Genesis/Genesis-28-36">Genesis 28-36</a></li><li><a href="../Religion/Bible/Genesis/Genesis-37-50" data-for="Religion/Bible/Genesis/Genesis-37-50">Genesis 37-50</a></li></ul></div></li><li><a href="../Religion/Bible/Bible" data-for="Religion/Bible/Bible">Bible</a></li></ul></div></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Screenplay-Writing"><button class="folder-button"><span class="folder-title">Screenplay Writing</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Screenplay-Writing"><li><a href="../Screenplay-Writing/Screenplay-Course" data-for="Screenplay-Writing/Screenplay-Course">Screenplay Course</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Verilog"><button class="folder-button"><span class="folder-title">Verilog</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Verilog"><li><a href="../Verilog/learning_verilog" data-for="Verilog/learning_verilog">learning_verilog</a></li></ul></div></li><li><a href="../Content-Feed" data-for="Content-Feed">Content Feed</a></li></ul></div></li><li id="explorer-end"></li></ul></div></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> ‚ùØ </p></div><div class="breadcrumb-element"><a href="../CUDA/">CUDA</a><p> ‚ùØ </p></div><div class="breadcrumb-element"><a href>CUDA</a></div></nav><h1 class="article-title">CUDA</h1><p show-comma="true" class="content-meta"><span>Nov 05, 2025</span><span>12 min read</span></p></div></div><article class="popover-hint"><p><a href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/" class="external">https://docs.nvidia.com/cuda/cuda-c-programming-guide/<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<h1 id="definition">Definition<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#definition" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<ul>
<li>
<p>host: the CPU</p>
</li>
<li>
<p>device: the GPU</p>
</li>
<li>
<p>host memory: the system main memory</p>
</li>
<li>
<p>device memory: onboard memory on a GPU card</p>
</li>
<li>
<p>kernels: a GPU function launched by the host and executed on the device</p>
</li>
<li>
<p>device function: a GPU function executed on the device which can only be called from the device (i.e. from a kernel or another device function)</p>
</li>
</ul>
<h2 id="1-introduction">1. Introduction<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-introduction" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>
<p><strong>GPU Application</strong><a href="https://www.nvidia.com/en-us/gpu-accelerated-applications/" class="external">https://www.nvidia.com/en-us/gpu-accelerated-applications/<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</li>
<li>
<p>FPGAs also energy efficient but don‚Äôt offer much programming flexibility</p>
</li>
<li>
<p>GPU design for highly parallel computation. More transistors are devote to data processing.</p>
</li>
</ul>
<h2 id="2-cuda-general-purpose-parallel-computing-platform-and-programming-model">2. CUDA: General Purpose Parallel Computing Platform and Programming Model<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-cuda-general-purpose-parallel-computing-platform-and-programming-model" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>CUDA comes with a software environment that can use C++. Also available are FORTRAN, DirectCompute, OpenACC.</p>
<h2 id="3-scalable-programming-model">3. Scalable Programming Model<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-scalable-programming-model" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>
<p>CUDA parallel programming is design to overcome parallelism problems for GPUs</p>
</li>
<li>
<p>Three key abstractions:</p>
<ol>
<li>
<p>hierarchy of thread groups</p>
</li>
<li>
<p>shared memories</p>
</li>
<li>
<p>barrier synchronization</p>
</li>
</ol>
</li>
<li>
<p>Automatic scalability</p>
</li>
<li>
<p>GPU is built around an array of <a href="#hardware-implementation" class="internal alias">Streaming Multiprocessors (SMs)</a></p>
</li>
</ul>
<h2 id="4-document-structure">4. Document Structure<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#4-document-structure" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><em>just describes document structure</em></p>
<h2 id="5-programming-model">5. Programming Model<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#5-programming-model" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Full code for the <a href="#vectorAdd-CUDA-sample" class="internal alias">vector addition example</a></p>
<h3 id="kernels">Kernels<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#kernels" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>CUDA C++ extends C++ by allowing programmer to define C++ functions called <em>kernels</em>, that when called, are executed N times in parallel by N different <em>CUDA threads</em>. This is opposed to only once like regular C++ functions.</p>
<ul>
<li>
<p>Kernel is defined using <code>__global__</code> declaration specifier and the number of CUDA threads that kernel for a given kernel call is specified using a new <code>&lt;&lt;&lt;...>>> execution configuration</code> syntax.</p>
</li>
<li>
<p>Each thread that executes the kernel is given a unique thread ID that is accessible within the kernel through built-in variables</p>
</li>
</ul>
<p><em>ex.</em> As an illustration, the following sample code, using the built-in variable threadIdx, adds two vectors A and B of size N and stores the result into vector C:</p>
<pre><code>‚àï‚àï Kernel definition
__global__ void VecAdd(float* A, float* B, float* C) {

  int i = threadIdx.x;

  C[i] = A[i] + B[i];
}

int main() { ...

‚àï‚àï Kernel invocation with N threads VecAdd&lt;&lt;&lt;1, N>>>(A, B, C); ...

}
</code></pre>
<p>Here, each of the <em>N</em> threads that execute <code>VecAdd(0</code> performs one pair-wise addition</p>
<h3 id="thread-hierarchy">Thread Hierarchy<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#thread-hierarchy" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p>A ‚Äúthread block‚Äù refers to a group of threads that are executed simultaneously on the same processor or core. In parallel computing, threads are organized into blocks based on their access patterns and spatial locality. For example, in a vector processing algorithm, threads might be grouped into blocks based on the index of the vector element they are operating on.</p>
</li>
<li>
<p>The relationship between a thread‚Äôs index and its thread ID is straightforward:</p>
<ul>
<li>
<p>For a one-dimensional block, the thread ID is simply the same as the thread index.</p>
</li>
<li>
<p>For a two-dimensional block of size (Dx, Dy), the thread ID of a thread of index (x, y) is (x + y Dx).</p>
</li>
<li>
<p>For a three-dimensional block of size (Dx, Dy, Dz), the thread ID of a thread of index (x, y, z) is (x + y Dx + z Dx Dy).</p>
</li>
</ul>
</li>
<li>
<p>In each case, the thread ID is calculated by adding the component of the index that corresponds to the dimension of the block in which the thread is executing. This allows threads to be addressed and communicated with within a block, as well as across blocks.</p>
</li>
</ul>
<p><strong>What does it mean for a block to be a one-dimensional block?</strong> In the context of parallel computing, a ‚Äúone-dimensional block‚Äù refers to a block of threads where all threads are executed in a single dimension. In other words, all threads within the block have the same index in that dimension.</p>
<p>For example, consider a vector processing algorithm that operates on vectors of length N. In this case, each thread can be assigned an index from 0 to N-1, and all threads within a block will have the same index in the same dimension (i.e., all threads within the block are executing the same operation on the same position of the vector).</p>
<p>In this scenario, the thread ID calculation would be simple: for any thread within the block, its thread ID is simply its index within the block. So, for example, if a thread with index 2 is within a one-dimensional block of size 5, then its thread ID is 2.</p>
<p>One-dimensional blocks are useful when the access pattern and spatial locality of the threads are well-defined in a single dimension. This allows for efficient parallelization and coordination within the block, as all threads can be addressed and communicated with using a simple index.</p>
<h3 id="threadidx"><code>threadIdx</code><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#threadidx" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><a href="../CUDA/3-component-vector-that-represent-the-thread-index-within-a-block-1" class="internal alias" data-slug="CUDA/3-component-vector-that-represent-the-thread-index-within-a-block-1">3-component vector that represent the thread index within a block 1</a>. Makes it natural to represent a vector, matrix, and volume.</p>
<p>In the CUDA programming model, <code>threadIdx</code> is a 3-component vector that represents the thread index within a block. The three components are:</p>
<ul>
<li>
<p><code>threadIdx.x</code>: The index of the thread in the one-dimensional dimension of the block. For a one-dimensional block, this is the same as the thread ID.</p>
</li>
<li>
<p><code>threadIdx.y</code>: The index of the thread in the two-dimensional dimension of the block (if the block size is greater than 1).</p>
</li>
<li>
<p><code>threadIdx.z</code>: The index of the thread in the three-dimensional dimension of the block (if the block size is greater than 2).</p>
</li>
</ul>
<p>The relationship between <code>threadIdx</code> and the thread ID is straightforward: For a one-dimensional block, <code>threadIdx</code> and <code>threadID</code> are the same; for a two-dimensional block of size <code>(Dx, Dy)</code>, <code>threadIdx.y</code> represents the thread ID of a thread of index <code>(x, y)</code> as <code>(x + y * Dx)</code>. For a three-dimensional block of size <code>(Dx, Dy, Dz)</code>, <code>threadIdx.z</code> represents the thread ID of a thread of index <code>(x, y, z)</code> as <code>(x + y * Dx + z * Dx * Dy)</code>.</p>
<p>The <code>threadIdx</code> vector is used to identify threads within a block, and it is used in conjunction with the <code>blockDim</code> vector to access threads within a block. The <code>blockDim</code> vector represents the size of the block in each dimension, and it is used to calculate the index of a thread within the block.</p>
<p>The limit on the number of threads per block is due to the fact that all threads within a block must share the limited memory resources of the same streaming multiprocessor core. On current GPUs, a thread block may contain up to 1024 threads. However, multiple equally-shaped thread blocks can be executed simultaneously, allowing the total number of threads to be equal to the number of threads per block in each dimension.</p>
<p>Cooperative groups are used to enable efficient cooperation among threads within a block. Shared memory is expected to be a low-latency memory near each processor core (much like an L1 cache), and <code>__syncthreads()</code> is expected to be lightweight. Cooperative groups provide a rich set of thread-synchronization primitives that can be used to coordinate memory accesses among threads within a block.</p>
<p><strong>Streaming multiprocessor core</strong></p>
<h3 id="thread-block-clusters">Thread block clusters<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#thread-block-clusters" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h2 id="programming-interface">Programming Interface<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#programming-interface" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="compilation-with-nvcc">Compilation with nvcc<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#compilation-with-nvcc" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p>Kernels can be written using the CUDA instruction set architecture called <code>PTX</code>.</p>
</li>
<li>
<p>More effective to use high-level programming language such as C++</p>
</li>
<li>
<p>Both cases, kernels must be compiled into binary code by <code>nvcc</code> to execute on device</p>
</li>
</ul>
<h3 id="nvcc">nvcc<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#nvcc" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>compiler drive to simplify process of compiling C++ or PTX code</li>
</ul>
<p>Link [[<code>nvcc</code> user manual]]</p>
<p><strong>Compilation workflow</strong></p>
<ol>
<li><strong>Offline compilation</strong></li>
</ol>
<ul>
<li>
<p>nvcc basic workflow consists of separate GPU code from CPU code and then:</p>
<ol>
<li>
<p>Compiling GPU code into PTX code and/or binary form ([[<code>cubin</code>]] object)</p>
</li>
<li>
<p>modifying host code by replacing the <code>&lt;&lt;&lt;...>>></code> by necessary CUDA runtime function calls to load and launch each compiled kernel from the <code>PTX</code> code and/or <code>cubin</code> object</p>
</li>
</ol>
</li>
</ul>
<p>The modified host code is output either as C++ code that is left to be compiled using another tool or as object code directly by letting nvcc invoke the host compiler during the last compilation stage (<a href="NOTE:%20can%20this%20be%20made%20efficient?" class="external">NOTE: can this be made efficient?<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>)</p>
<p>Applications can then:</p>
<ul>
<li>
<p>either link to the compiled host code (this is the most common use case)</p>
</li>
<li>
<p>Or ignore the modified host code (if any) and use the <a href="#driver-api" class="internal alias">CUDA driver API</a> to load and execute the PTX code or cubin object</p>
</li>
</ul>
<ol start="2">
<li><strong>Just-in-Time Compilation</strong></li>
</ol>
<p>Just-in-time (JIT) compilation is a technique where code is compiled and executed on the fly, at the time it‚Äôs needed, rather than being compiled and loaded into memory all at once. In the context of CUDA, JIT compilation is used to compile C++ device code into PTX binary code that can be executed directly on the GPU.</p>
<p>Here‚Äôs how it works:</p>
<ol>
<li>
<p>When an application is launched, the device driver compiles any PTX code loaded by the application at runtime using a just-in-time compiler. This increases the load time of the application, but allows it to benefit from any new compiler improvements that come with each new device driver release.</p>
</li>
<li>
<p>The compiled binary code is cached by the device driver for subsequent invocations of the application to avoid repeating the compilation process. The cache is automatically invalidated when the device driver is upgraded, so applications can benefit from the improvements in the new just-in-time compiler built into the device driver.</p>
</li>
<li>
<p>Environment variables can be used to control JIT compilation, as described in CUDA Environment Variables.</p>
</li>
<li>
<p>As an alternative to using nvcc to compile CUDA C++ device code, NVRTC (NVIDIA Runtime Compilation) can be used to compile CUDA C++ device code to PTX at runtime. NVRTC is a runtime compilation library for CUDA C++; more information can be found in the NVRTC User guide.</p>
</li>
</ol>
<p>Examples of JIT compilation in action:</p>
<ol>
<li>
<p>Imagine an application that needs to perform a computationally intensive task, such as matrix multiplication. Instead of loading the entire code for the matrix multiplication function at once, the device driver can compile just-in-time the necessary parts of the function when the application invokes it. This reduces the load time and memory usage, while still allowing the application to benefit from any optimizations that come with each new device driver release.</p>
</li>
<li>
<p>Another example is a web browser that needs to render 3D graphics for a web page. Instead of loading the entire 3D rendering engine at once, the device driver can compile just-in-time the necessary parts of the engine when the browser invokes them. This reduces the load time and memory usage, while still allowing the browser to benefit from any optimizations that come with each new device driver release.</p>
</li>
</ol>
<p>In summary, JIT compilation in CUDA allows applications to benefit from improved compilers and other optimizations without requiring a complete code recompilation when the device driver changes. It does this by compiling only the necessary parts of the application at runtime, caching the results for subsequent invocations, and invalidating the cache when the device driver is upgraded.</p>
<ol>
<li>What does ‚Äúnew device driver changes‚Äù mean?</li>
</ol>
<p>When we talk about ‚Äúnew device driver changes,‚Äù we‚Äôre referring to updates or improvements made to the device driver that runs on the GPU. The device driver is responsible for managing the communication between the CPU and the GPU, and it provides a layer of abstraction between the two. As new hardware technologies are developed, the device driver may be updated to take advantage of these advancements. These updates could include improved support for parallel processing, faster data transfer rates, or new features that allow developers to create more complex and powerful applications.</p>
<p>When a new device driver is released, it may introduce changes to the way code is compiled and executed on the GPU. For example, the new driver might provide better support for a particular programming model or feature, or it might introduce new APIs or abstractions that simplify development. In either case, these changes can affect how code is compiled and executed, and JIT compilation helps ensure that applications can take advantage of these improvements without requiring a complete code recompilation.</p>
<ol start="2">
<li>Does this mean that code won‚Äôt be compiled unless the JIT thinks it‚Äôll be needed?</li>
</ol>
<p>Not exactly. JIT compilation is designed to optimize code execution based on the specific needs of the application and the hardware platform it‚Äôs running on. When an application loads PTX code, the device driver will perform just-in-time compilation only if necessary. This means that not all PTX code will be compiled at once; instead, the JIT compiler will only compile the parts of the code that are actually needed by the application.</p>
<p>For example, imagine an application that performs a matrix multiplication operation. If the application only needs to perform this operation a few times, then the JIT compiler won‚Äôt compile the entire matrix multiplication function at once. Instead, it will only compile the specific parts of the function that are needed for those few invocations. This can reduce the load time and memory usage for the application, while still allowing it to benefit from any optimizations that come with each new device driver release.</p>
<p>In summary, JIT compilation is a dynamic optimization technique that helps optimize code execution based on the specific needs of the application and the hardware platform it‚Äôs running on. It doesn‚Äôt mean that code won‚Äôt be compiled unless the JIT thinks it‚Äôll be needed; instead, it means that the JIT will only compile the necessary parts of the code at runtime to optimize performance.</p>
<h3 id="binary-compatibility">Binary Compatibility<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#binary-compatibility" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>[[<em>Compute capability</em> seems to be a big thing]]</p>
<p>Binary code is architecture specific. A <code>cubin</code> object is generated using the compiler option <code>-code</code> that specifies the targeted architecture.</p>
<h3 id="ptx-compatibility">PTX Compatibility<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ptx-compatibility" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><a href="#warp-shuffle-functions" class="internal alias">Warp Shuffle Functions</a></p>
<h3 id="application-compatibility">Application Compatibility<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#application-compatibility" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>To execute code on devices of specific compute capability, an application must load binary or PTX code that is compatible with this compute capability.</p>
<p>Review this section with access to the [[<code>nvcc</code> user manual]]</p>
<h3 id="cuda-runtime">CUDA runtime<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cuda-runtime" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Runtime is implemented in the <code>cudart</code> library which is linked to the application either statically via <code>cudart.lib</code> or <code>libcudart.a</code> or dynamically via <code>cudart.dll</code> or <code>lidcudart.so</code>.</p>
<h4 id="1-initialization">1. Initialization<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-initialization" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4></article></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false}"></div><svg version="1.1" id="global-graph-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
	s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
	c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
	C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
	c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
	v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
	s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
	C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
	S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
	s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
	s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" id="toc" class><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content"><ul class="overflow"><li class="depth-0"><a href="#definition" data-for="definition">Definition</a></li><li class="depth-1"><a href="#1-introduction" data-for="1-introduction">1. Introduction</a></li><li class="depth-1"><a href="#2-cuda-general-purpose-parallel-computing-platform-and-programming-model" data-for="2-cuda-general-purpose-parallel-computing-platform-and-programming-model">2. CUDA: General Purpose Parallel Computing Platform and Programming Model</a></li><li class="depth-1"><a href="#3-scalable-programming-model" data-for="3-scalable-programming-model">3. Scalable Programming Model</a></li><li class="depth-1"><a href="#4-document-structure" data-for="4-document-structure">4. Document Structure</a></li><li class="depth-1"><a href="#5-programming-model" data-for="5-programming-model">5. Programming Model</a></li><li class="depth-2"><a href="#kernels" data-for="kernels">Kernels</a></li><li class="depth-2"><a href="#thread-hierarchy" data-for="thread-hierarchy">Thread Hierarchy</a></li><li class="depth-2"><a href="#threadidx" data-for="threadidx">threadIdx</a></li><li class="depth-2"><a href="#thread-block-clusters" data-for="thread-block-clusters">Thread block clusters</a></li><li class="depth-1"><a href="#programming-interface" data-for="programming-interface">Programming Interface</a></li><li class="depth-2"><a href="#compilation-with-nvcc" data-for="compilation-with-nvcc">Compilation with nvcc</a></li><li class="depth-2"><a href="#nvcc" data-for="nvcc">nvcc</a></li><li class="depth-2"><a href="#binary-compatibility" data-for="binary-compatibility">Binary Compatibility</a></li><li class="depth-2"><a href="#ptx-compatibility" data-for="ptx-compatibility">PTX Compatibility</a></li><li class="depth-2"><a href="#application-compatibility" data-for="application-compatibility">Application Compatibility</a></li><li class="depth-2"><a href="#cuda-runtime" data-for="cuda-runtime">CUDA runtime</a></li></ul></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li>No backlinks found</li></ul></div></div></div><footer class><hr/><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.2.3</a> ¬© 2025</p><ul><li><a href="https://github.com/viraatdas/notes">GitHub</a></li><li><a href="https://viraat.dev/">Made by Viraat</a></li></ul></footer></div></body><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          let mermaidImport = undefined
          document.addEventListener('nav', async () => {
            if (document.querySelector("code.mermaid")) {
              mermaidImport ||= await import('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs')
              const mermaid = mermaidImport.default
              const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
              mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                theme: darkMode ? 'dark' : 'default'
              })

              await mermaid.run({
                querySelector: '.mermaid'
              })
            }
          });
          </script><script type="application/javascript">
            const socket = new WebSocket('ws://localhost:3001')
            // reload(true) ensures resources like images and scripts are fetched again in firefox
            socket.addEventListener('message', () => document.location.reload(true))
          </script><script src="../postscript.js" type="module"></script></html>